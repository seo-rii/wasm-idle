import{g as Ce}from"./_commonjsHelpers.725317a4.js";function pe(Z,_e){for(var ee=0;ee<_e.length;ee++){const J=_e[ee];if(typeof J!="string"&&!Array.isArray(J)){for(const X in J)if(X!=="default"&&!(X in Z)){const te=Object.getOwnPropertyDescriptor(J,X);te&&Object.defineProperty(Z,X,te.get?te:{enumerable:!0,get:()=>J[X]})}}}return Object.freeze(Object.defineProperty(Z,Symbol.toStringTag,{value:"Module"}))}var de={},me={get exports(){return de},set exports(Z){de=Z}};(function(Z,_e){(function(ee,J){Z.exports=J()})(self,function(){return(()=>{var ee={965:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlyphRenderer=void 0;const u=c(381),o=c(855),r=c(859),d=c(374),v=c(509),h=11,e=h*Float32Array.BYTES_PER_ELEMENT;let t,g=0,R=0,m=0;class y extends r.Disposable{constructor(n,C,p){super(),this._terminal=n,this._gl=C,this._dimensions=p,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};const s=this._gl;v.TextureAtlas.maxAtlasPages===void 0&&(v.TextureAtlas.maxAtlasPages=Math.min(32,(0,d.throwIfFalsy)(s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS))),v.TextureAtlas.maxTextureSize=(0,d.throwIfFalsy)(s.getParameter(s.MAX_TEXTURE_SIZE))),this._program=(0,d.throwIfFalsy)((0,u.createProgram)(s,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(b){let E="";for(let L=1;L<b;L++)E+=` else if (v_texpage == ${L}) { outColor = texture(u_texture[${L}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${b}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${E}
}`}(v.TextureAtlas.maxAtlasPages))),this.register((0,r.toDisposable)(()=>s.deleteProgram(this._program))),this._projectionLocation=(0,d.throwIfFalsy)(s.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,d.throwIfFalsy)(s.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,d.throwIfFalsy)(s.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=s.createVertexArray(),s.bindVertexArray(this._vertexArrayObject);const _=new Float32Array([0,0,1,0,0,1,1,1]),a=s.createBuffer();this.register((0,r.toDisposable)(()=>s.deleteBuffer(a))),s.bindBuffer(s.ARRAY_BUFFER,a),s.bufferData(s.ARRAY_BUFFER,_,s.STATIC_DRAW),s.enableVertexAttribArray(0),s.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);const f=new Uint8Array([0,1,2,3]),l=s.createBuffer();this.register((0,r.toDisposable)(()=>s.deleteBuffer(l))),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,l),s.bufferData(s.ELEMENT_ARRAY_BUFFER,f,s.STATIC_DRAW),this._attributesBuffer=(0,d.throwIfFalsy)(s.createBuffer()),this.register((0,r.toDisposable)(()=>s.deleteBuffer(this._attributesBuffer))),s.bindBuffer(s.ARRAY_BUFFER,this._attributesBuffer),s.enableVertexAttribArray(2),s.vertexAttribPointer(2,2,s.FLOAT,!1,e,0),s.vertexAttribDivisor(2,1),s.enableVertexAttribArray(3),s.vertexAttribPointer(3,2,s.FLOAT,!1,e,2*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(3,1),s.enableVertexAttribArray(4),s.vertexAttribPointer(4,1,s.FLOAT,!1,e,4*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(4,1),s.enableVertexAttribArray(5),s.vertexAttribPointer(5,2,s.FLOAT,!1,e,5*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(5,1),s.enableVertexAttribArray(6),s.vertexAttribPointer(6,2,s.FLOAT,!1,e,7*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(6,1),s.enableVertexAttribArray(1),s.vertexAttribPointer(1,2,s.FLOAT,!1,e,9*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(1,1),s.useProgram(this._program);const x=new Int32Array(v.TextureAtlas.maxAtlasPages);for(let b=0;b<v.TextureAtlas.maxAtlasPages;b++)x[b]=b;s.uniform1iv(this._textureLocation,x),s.uniformMatrix4fv(this._projectionLocation,!1,u.PROJECTION_MATRIX),this._atlasTextures=[];for(let b=0;b<v.TextureAtlas.maxAtlasPages;b++){const E=new u.GLTexture((0,d.throwIfFalsy)(s.createTexture()));this.register((0,r.toDisposable)(()=>s.deleteTexture(E.texture))),s.activeTexture(s.TEXTURE0+b),s.bindTexture(s.TEXTURE_2D,E.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[b]=E}s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(n,C,p,s,_,a,f,l){this._updateCell(this._vertices.attributes,n,C,p,s,_,a,f,l)}_updateCell(n,C,p,s,_,a,f,l,x){g=(p*this._terminal.cols+C)*h,s!==o.NULL_CELL_CODE&&s!==void 0?this._atlas&&(t=l&&l.length>1?this._atlas.getRasterizedGlyphCombinedChar(l,_,a,f):this._atlas.getRasterizedGlyph(s,_,a,f),R=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),_!==x&&t.offset.x>R?(m=t.offset.x-R,n[g]=-(t.offset.x-m)+this._dimensions.device.char.left,n[g+1]=-t.offset.y+this._dimensions.device.char.top,n[g+2]=(t.size.x-m)/this._dimensions.device.canvas.width,n[g+3]=t.size.y/this._dimensions.device.canvas.height,n[g+4]=t.texturePage,n[g+5]=t.texturePositionClipSpace.x+m/this._atlas.pages[t.texturePage].canvas.width,n[g+6]=t.texturePositionClipSpace.y,n[g+7]=t.sizeClipSpace.x-m/this._atlas.pages[t.texturePage].canvas.width,n[g+8]=t.sizeClipSpace.y):(n[g]=-t.offset.x+this._dimensions.device.char.left,n[g+1]=-t.offset.y+this._dimensions.device.char.top,n[g+2]=t.size.x/this._dimensions.device.canvas.width,n[g+3]=t.size.y/this._dimensions.device.canvas.height,n[g+4]=t.texturePage,n[g+5]=t.texturePositionClipSpace.x,n[g+6]=t.texturePositionClipSpace.y,n[g+7]=t.sizeClipSpace.x,n[g+8]=t.sizeClipSpace.y)):n.fill(0,g,g+h-1-2)}clear(){const n=this._terminal,C=n.cols*n.rows*h;this._vertices.count!==C?this._vertices.attributes=new Float32Array(C):this._vertices.attributes.fill(0);let p=0;for(;p<this._vertices.attributesBuffers.length;p++)this._vertices.count!==C?this._vertices.attributesBuffers[p]=new Float32Array(C):this._vertices.attributesBuffers[p].fill(0);this._vertices.count=C,p=0;for(let s=0;s<n.rows;s++)for(let _=0;_<n.cols;_++)this._vertices.attributes[p+9]=_/n.cols,this._vertices.attributes[p+10]=s/n.rows,p+=h}handleResize(){const n=this._gl;n.viewport(0,0,n.canvas.width,n.canvas.height),n.uniform2f(this._resolutionLocation,n.canvas.width,n.canvas.height),this.clear()}render(n){if(!this._atlas)return;const C=this._gl;C.useProgram(this._program),C.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;const p=this._vertices.attributesBuffers[this._activeBuffer];let s=0;for(let _=0;_<n.lineLengths.length;_++){const a=_*this._terminal.cols*h,f=this._vertices.attributes.subarray(a,a+n.lineLengths[_]*h);p.set(f,s),s+=f.length}C.bindBuffer(C.ARRAY_BUFFER,this._attributesBuffer),C.bufferData(C.ARRAY_BUFFER,p.subarray(0,s),C.STREAM_DRAW);for(let _=0;_<this._atlas.pages.length;_++)this._atlas.pages[_].version!==this._atlasTextures[_].version&&this._bindAtlasPageTexture(C,this._atlas,_);C.drawElementsInstanced(C.TRIANGLE_STRIP,4,C.UNSIGNED_BYTE,0,s/h)}setAtlas(n){this._atlas=n;for(const C of this._atlasTextures)C.version=-1}_bindAtlasPageTexture(n,C,p){n.activeTexture(n.TEXTURE0+p),n.bindTexture(n.TEXTURE_2D,this._atlasTextures[p].texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,C.pages[p].canvas),n.generateMipmap(n.TEXTURE_2D),this._atlasTextures[p].version=C.pages[p].version}setDimensions(n){this._dimensions=n}}i.GlyphRenderer=y},742:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RectangleRenderer=void 0;const u=c(381),o=c(310),r=c(859),d=c(237),v=c(374),h=8*Float32Array.BYTES_PER_ELEMENT;let e=0,t=!1,g=0,R=0,m=0,y=0,M=0,n=0;class C extends r.Disposable{constructor(s,_,a,f){super(),this._terminal=s,this._gl=_,this._dimensions=a,this._themeService=f,this._vertices={count:0,attributes:new Float32Array(160)};const l=this._gl;this._program=(0,v.throwIfFalsy)((0,u.createProgram)(l,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,r.toDisposable)(()=>l.deleteProgram(this._program))),this._projectionLocation=(0,v.throwIfFalsy)(l.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=l.createVertexArray(),l.bindVertexArray(this._vertexArrayObject);const x=new Float32Array([0,0,1,0,0,1,1,1]),b=l.createBuffer();this.register((0,r.toDisposable)(()=>l.deleteBuffer(b))),l.bindBuffer(l.ARRAY_BUFFER,b),l.bufferData(l.ARRAY_BUFFER,x,l.STATIC_DRAW),l.enableVertexAttribArray(3),l.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);const E=new Uint8Array([0,1,2,3]),L=l.createBuffer();this.register((0,r.toDisposable)(()=>l.deleteBuffer(L))),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,L),l.bufferData(l.ELEMENT_ARRAY_BUFFER,E,l.STATIC_DRAW),this._attributesBuffer=(0,v.throwIfFalsy)(l.createBuffer()),this.register((0,r.toDisposable)(()=>l.deleteBuffer(this._attributesBuffer))),l.bindBuffer(l.ARRAY_BUFFER,this._attributesBuffer),l.enableVertexAttribArray(0),l.vertexAttribPointer(0,2,l.FLOAT,!1,h,0),l.vertexAttribDivisor(0,1),l.enableVertexAttribArray(1),l.vertexAttribPointer(1,2,l.FLOAT,!1,h,2*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(1,1),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.FLOAT,!1,h,4*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(2,1),this._updateCachedColors(f.colors),this.register(this._themeService.onChangeColors(w=>{this._updateCachedColors(w),this._updateViewportRectangle()}))}render(){const s=this._gl;s.useProgram(this._program),s.bindVertexArray(this._vertexArrayObject),s.uniformMatrix4fv(this._projectionLocation,!1,u.PROJECTION_MATRIX),s.bindBuffer(s.ARRAY_BUFFER,this._attributesBuffer),s.bufferData(s.ARRAY_BUFFER,this._vertices.attributes,s.DYNAMIC_DRAW),s.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,s.UNSIGNED_BYTE,0,this._vertices.count)}handleResize(){this._updateViewportRectangle()}setDimensions(s){this._dimensions=s}_updateCachedColors(s){this._bgFloat=this._colorToFloat32Array(s.background)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(s){const _=this._terminal,a=this._vertices;let f,l,x,b,E,L,w,T,A,S,P,N=1;for(f=0;f<_.rows;f++){for(x=-1,b=0,E=0,L=!1,l=0;l<_.cols;l++)w=(f*_.cols+l)*o.RENDER_MODEL_INDICIES_PER_CELL,T=s.cells[w+o.RENDER_MODEL_BG_OFFSET],A=s.cells[w+o.RENDER_MODEL_FG_OFFSET],S=!!(67108864&A),(T!==b||A!==E&&(L||S))&&((b!==0||L&&E!==0)&&(P=8*N++,this._updateRectangle(a,P,E,b,x,l,f)),x=l,b=T,E=A,L=S);(b!==0||L&&E!==0)&&(P=8*N++,this._updateRectangle(a,P,E,b,x,_.cols,f))}a.count=N}_updateRectangle(s,_,a,f,l,x,b){if(t=!1,67108864&a)switch(50331648&a){case 16777216:case 33554432:e=this._themeService.colors.ansi[255&a].rgba;break;case 50331648:e=(16777215&a)<<8;break;default:e=this._themeService.colors.foreground.rgba}else switch(50331648&f){case 16777216:case 33554432:e=this._themeService.colors.ansi[255&f].rgba;break;case 50331648:e=(16777215&f)<<8;break;default:e=this._themeService.colors.background.rgba,t=!0}s.attributes.length<_+4&&(s.attributes=(0,u.expandFloat32Array)(s.attributes,this._terminal.rows*this._terminal.cols*8)),g=l*this._dimensions.device.cell.width,R=b*this._dimensions.device.cell.height,m=(e>>24&255)/255,y=(e>>16&255)/255,M=(e>>8&255)/255,n=!t&&134217728&f?d.DIM_OPACITY:1,this._addRectangle(s.attributes,_,g,R,(x-l)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,m,y,M,n)}_addRectangle(s,_,a,f,l,x,b,E,L,w){s[_]=a/this._dimensions.device.canvas.width,s[_+1]=f/this._dimensions.device.canvas.height,s[_+2]=l/this._dimensions.device.canvas.width,s[_+3]=x/this._dimensions.device.canvas.height,s[_+4]=b,s[_+5]=E,s[_+6]=L,s[_+7]=w}_addRectangleFloat(s,_,a,f,l,x,b){s[_]=a/this._dimensions.device.canvas.width,s[_+1]=f/this._dimensions.device.canvas.height,s[_+2]=l/this._dimensions.device.canvas.width,s[_+3]=x/this._dimensions.device.canvas.height,s[_+4]=b[0],s[_+5]=b[1],s[_+6]=b[2],s[_+7]=b[3]}_colorToFloat32Array(s){return new Float32Array([(s.rgba>>24&255)/255,(s.rgba>>16&255)/255,(s.rgba>>8&255)/255,(255&s.rgba)/255])}}i.RectangleRenderer=C},310:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RenderModel=i.COMBINED_CHAR_BIT_MASK=i.RENDER_MODEL_EXT_OFFSET=i.RENDER_MODEL_FG_OFFSET=i.RENDER_MODEL_BG_OFFSET=i.RENDER_MODEL_INDICIES_PER_CELL=void 0;const u=c(296);i.RENDER_MODEL_INDICIES_PER_CELL=4,i.RENDER_MODEL_BG_OFFSET=1,i.RENDER_MODEL_FG_OFFSET=2,i.RENDER_MODEL_EXT_OFFSET=3,i.COMBINED_CHAR_BIT_MASK=2147483648,i.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,u.createSelectionRenderModel)()}resize(o,r){const d=o*r*i.RENDER_MODEL_INDICIES_PER_CELL;d!==this.cells.length&&(this.cells=new Uint32Array(d),this.lineLengths=new Uint32Array(r))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.JoinedCellData=i.WebglRenderer=void 0;const u=c(820),o=c(274),r=c(627),d=c(56),v=c(374),h=c(147),e=c(782),t=c(855),g=c(345),R=c(859),m=c(965),y=c(742),M=c(461),n=c(733),C=c(310);class p extends R.Disposable{constructor(a,f,l,x,b,E,L,w,T){super(),this._terminal=a,this._characterJoinerService=f,this._charSizeService=l,this._coreBrowserService=x,this._decorationService=E,this._optionsService=L,this._themeService=w,this._model=new C.RenderModel,this._workCell=new e.CellData,this._onChangeTextureAtlas=this.register(new g.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new g.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new g.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new g.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new g.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new o.CellColorResolver(this._terminal,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new n.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier2,this._coreBrowserService,L,this._themeService),new M.CursorRenderLayer(a,this._core.screenElement,3,this._onRequestRedraw,this._coreBrowserService,b,L,this._themeService)],this.dimensions=(0,v.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this.register(L.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=document.createElement("canvas");const A={antialias:!1,depth:!1,preserveDrawingBuffer:T};if(this._gl=this._canvas.getContext("webgl2",A),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,u.addDisposableDomListener)(this._canvas,"webglcontextlost",S=>{console.log("webglcontextlost event received"),S.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire(S)},3e3)})),this.register((0,u.addDisposableDomListener)(this._canvas,"webglcontextrestored",S=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,r.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this.register((0,d.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,(S,P)=>this._setCanvasDevicePixelDimensions(S,P))),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer,this._glyphRenderer]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,R.toDisposable)(()=>{var S;for(const P of this._renderLayers)P.dispose();(S=this._canvas.parentElement)===null||S===void 0||S.removeChild(this._canvas),(0,r.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){var a;return(a=this._charAtlas)===null||a===void 0?void 0:a.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(a,f){this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(const l of this._renderLayers)l.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,this._rectangleRenderer.setDimensions(this.dimensions),this._rectangleRenderer.handleResize(),this._glyphRenderer.setDimensions(this.dimensions),this._glyphRenderer.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){for(const a of this._renderLayers)a.handleBlur(this._terminal);this._requestRedrawViewport()}handleFocus(){for(const a of this._renderLayers)a.handleFocus(this._terminal);this._requestRedrawViewport()}handleSelectionChanged(a,f,l){for(const x of this._renderLayers)x.handleSelectionChanged(this._terminal,a,f,l);this._model.selection.update(this._terminal,a,f,l),this._requestRedrawViewport()}handleCursorMove(){for(const a of this._renderLayers)a.handleCursorMove(this._terminal)}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas()}_initializeWebGLState(){var a,f;return(a=this._rectangleRenderer)===null||a===void 0||a.dispose(),(f=this._glyphRenderer)===null||f===void 0||f.dispose(),this._rectangleRenderer=this.register(new y.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService)),this._glyphRenderer=this.register(new m.GlyphRenderer(this._terminal,this._gl,this.dimensions)),this.handleCharSizeChanged(),[this._rectangleRenderer,this._glyphRenderer]}_refreshCharAtlas(){var a;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);const f=(0,r.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==f&&((a=this._charAtlasDisposable)===null||a===void 0||a.dispose(),this._onChangeTextureAtlas.fire(f.pages[0].canvas),this._charAtlasDisposable=(0,R.getDisposeArrayDisposable)([(0,g.forwardEvent)(f.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,g.forwardEvent)(f.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=f,this._charAtlas.warmUp(),this._glyphRenderer.setAtlas(this._charAtlas)}_clearModel(a){this._model.clear(),a&&this._glyphRenderer.clear()}clearTextureAtlas(){var a;(a=this._charAtlas)===null||a===void 0||a.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){this._clearModel(!0);for(const a of this._renderLayers)a.reset(this._terminal)}registerCharacterJoiner(a){return-1}deregisterCharacterJoiner(a){return!1}renderRows(a,f){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(const l of this._renderLayers)l.handleGridChanged(this._terminal,a,f);this._glyphRenderer.beginFrame()&&this._clearModel(!0),this._updateModel(a,f),this._rectangleRenderer.render(),this._glyphRenderer.render(this._model)}_updateModel(a,f){const l=this._core;let x,b,E,L,w,T,A,S,P,N,O,I,H,G=this._workCell;for(b=a;b<=f&&(E=b+l.buffer.ydisp,L=l.buffer.lines.get(E),L);b++)for(this._model.lineLengths[b]=0,w=this._characterJoinerService.getJoinedCharacters(E),I=0;I<l.cols;I++)if(x=this._cellColorResolver.result.bg,L.loadCell(I,G),I===0&&(x=this._cellColorResolver.result.bg),T=!1,A=I,w.length>0&&I===w[0][0]&&(T=!0,S=w.shift(),G=new s(G,L.translateToString(!0,S[0],S[1]),S[1]-S[0]),A=S[1]-1),P=G.getChars(),N=G.getCode(),O=(b*l.cols+I)*C.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(G,I,E),N!==t.NULL_CELL_CODE&&(this._model.lineLengths[b]=I+1),(this._model.cells[O]!==N||this._model.cells[O+C.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[O+C.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[O+C.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(P.length>1&&(N|=C.COMBINED_CHAR_BIT_MASK),this._model.cells[O]=N,this._model.cells[O+C.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[O+C.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[O+C.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.updateCell(I,b,N,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,P,x),T))for(G=this._workCell,I++;I<A;I++)H=(b*l.cols+I)*C.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.updateCell(I,b,t.NULL_CELL_CODE,0,0,0,t.NULL_CELL_CHAR,0),this._model.cells[H]=t.NULL_CELL_CODE,this._model.cells[H+C.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[H+C.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[H+C.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;this._rectangleRenderer.updateBackgrounds(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(a,f){this._canvas.width===a&&this._canvas.height===f||(this._canvas.width=a,this._canvas.height=f,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}}i.WebglRenderer=p;class s extends h.AttributeData{constructor(a,f,l){super(),this.content=0,this.combinedData="",this.fg=a.fg,this.bg=a.bg,this.combinedData=f,this._width=l}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(a){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.JoinedCellData=s},381:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GLTexture=i.expandFloat32Array=i.createShader=i.createProgram=i.PROJECTION_MATRIX=void 0;const u=c(374);function o(r,d,v){const h=(0,u.throwIfFalsy)(r.createShader(d));if(r.shaderSource(h,v),r.compileShader(h),r.getShaderParameter(h,r.COMPILE_STATUS))return h;console.error(r.getShaderInfoLog(h)),r.deleteShader(h)}i.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),i.createProgram=function(r,d,v){const h=(0,u.throwIfFalsy)(r.createProgram());if(r.attachShader(h,(0,u.throwIfFalsy)(o(r,r.VERTEX_SHADER,d))),r.attachShader(h,(0,u.throwIfFalsy)(o(r,r.FRAGMENT_SHADER,v))),r.linkProgram(h),r.getProgramParameter(h,r.LINK_STATUS))return h;console.error(r.getProgramInfoLog(h)),r.deleteProgram(h)},i.createShader=o,i.expandFloat32Array=function(r,d){const v=Math.min(2*r.length,d),h=new Float32Array(v);for(let e=0;e<r.length;e++)h[e]=r[e];return h},i.GLTexture=class{constructor(r){this.texture=r,this.version=-1}}},592:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseRenderLayer=void 0;const u=c(627),o=c(237),r=c(374),d=c(859);class v extends d.Disposable{constructor(e,t,g,R,m,y,M,n){super(),this._container=t,this._alpha=m,this._coreBrowserService=y,this._optionsService=M,this._themeService=n,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${g}-layer`),this._canvas.style.zIndex=R.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(C=>{this._refreshCharAtlas(e,C),this.reset(e)})),this.register((0,d.toDisposable)(()=>{var C;this._canvas.remove(),(C=this._charAtlas)===null||C===void 0||C.dispose()}))}_initCanvas(){this._ctx=(0,r.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(e){}handleFocus(e){}handleCursorMove(e){}handleGridChanged(e,t,g){}handleSelectionChanged(e,t,g,R=!1){}_setTransparency(e,t){if(t===this._alpha)return;const g=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,g),this._refreshCharAtlas(e,this._themeService.colors),this.handleGridChanged(e,0,e.rows-1)}_refreshCharAtlas(e,t){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,u.acquireTextureAtlas)(e,this._optionsService.rawOptions,t,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(e,t){this._deviceCellWidth=t.device.cell.width,this._deviceCellHeight=t.device.cell.height,this._deviceCharWidth=t.device.char.width,this._deviceCharHeight=t.device.char.height,this._deviceCharLeft=t.device.char.left,this._deviceCharTop=t.device.char.top,this._canvas.width=t.device.canvas.width,this._canvas.height=t.device.canvas.height,this._canvas.style.width=`${t.css.canvas.width}px`,this._canvas.style.height=`${t.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(e,this._themeService.colors)}_fillCells(e,t,g,R){this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,R*this._deviceCellHeight)}_fillBottomLineAtCells(e,t,g=1){this._ctx.fillRect(e*this._deviceCellWidth,(t+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,g*this._deviceCellWidth,this._coreBrowserService.dpr)}_fillLeftLineAtCell(e,t,g){this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,this._coreBrowserService.dpr*g,this._deviceCellHeight)}_strokeRectAtCell(e,t,g,R){this._ctx.lineWidth=this._coreBrowserService.dpr,this._ctx.strokeRect(e*this._deviceCellWidth+this._coreBrowserService.dpr/2,t*this._deviceCellHeight+this._coreBrowserService.dpr/2,g*this._deviceCellWidth-this._coreBrowserService.dpr,R*this._deviceCellHeight-this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(e,t,g,R){this._alpha?this._ctx.clearRect(e*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,R*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,R*this._deviceCellHeight))}_fillCharTrueColor(e,t,g,R){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline=o.TEXT_BASELINE,this._clipCell(g,R,t.getWidth()),this._ctx.fillText(t.getChars(),g*this._deviceCellWidth+this._deviceCharLeft,R*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(e,t,g){this._ctx.beginPath(),this._ctx.rect(e*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(e,t,g){return`${g?"italic":""} ${t?e.options.fontWeightBold:e.options.fontWeight} ${e.options.fontSize*this._coreBrowserService.dpr}px ${e.options.fontFamily}`}}i.BaseRenderLayer=v},461:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CursorRenderLayer=void 0;const u=c(592),o=c(782),r=c(859);class d extends u.BaseRenderLayer{constructor(e,t,g,R,m,y,M,n){super(e,t,"cursor",g,!0,m,M,n),this._onRequestRefreshRowsEvent=R,this._coreService=y,this._cell=new o.CellData,this._state={x:0,y:0,isFocused:!1,style:"",width:0},this._cursorRenderers={bar:this._renderBarCursor.bind(this),block:this._renderBlockCursor.bind(this),underline:this._renderUnderlineCursor.bind(this)},this._handleOptionsChanged(e),this.register(M.onOptionChange(()=>this._handleOptionsChanged(e))),this.register((0,r.toDisposable)(()=>{var C;(C=this._cursorBlinkStateManager)===null||C===void 0||C.dispose(),this._cursorBlinkStateManager=void 0}))}resize(e,t){super.resize(e,t),this._state={x:0,y:0,isFocused:!1,style:"",width:0}}reset(e){var t;this._clearCursor(),(t=this._cursorBlinkStateManager)===null||t===void 0||t.restartBlinkAnimation(e),this._handleOptionsChanged(e)}handleBlur(e){var t;(t=this._cursorBlinkStateManager)===null||t===void 0||t.pause(),this._onRequestRefreshRowsEvent.fire({start:e.buffer.active.cursorY,end:e.buffer.active.cursorY})}handleFocus(e){var t;(t=this._cursorBlinkStateManager)===null||t===void 0||t.resume(e),this._onRequestRefreshRowsEvent.fire({start:e.buffer.active.cursorY,end:e.buffer.active.cursorY})}_handleOptionsChanged(e){var t;e.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new v(()=>{this._render(e,!0)},this._coreBrowserService)):((t=this._cursorBlinkStateManager)===null||t===void 0||t.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRefreshRowsEvent.fire({start:e.buffer.active.cursorY,end:e.buffer.active.cursorY})}handleCursorMove(e){var t;(t=this._cursorBlinkStateManager)===null||t===void 0||t.restartBlinkAnimation(e)}handleGridChanged(e,t,g){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(e,!1):this._cursorBlinkStateManager.restartBlinkAnimation(e)}_render(e,t){if(!this._coreService.isCursorInitialized||this._coreService.isCursorHidden)return void this._clearCursor();const g=e.buffer.active.baseY+e.buffer.active.cursorY,R=g-e.buffer.active.viewportY,m=Math.min(e.buffer.active.cursorX,e.cols-1);if(R<0||R>=e.rows)this._clearCursor();else if(e._core.buffer.lines.get(g).loadCell(m,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css;const y=e.options.cursorStyle;return y&&y!=="block"?this._cursorRenderers[y](e,m,R,this._cell):this._renderBlurCursor(e,m,R,this._cell),this._ctx.restore(),this._state.x=m,this._state.y=R,this._state.isFocused=!1,this._state.style=y,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===m&&this._state.y===R&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===e.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[e.options.cursorStyle||"block"](e,m,R,this._cell),this._ctx.restore(),this._state.x=m,this._state.y=R,this._state.isFocused=!1,this._state.style=e.options.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}_clearCursor(){this._state&&(this._coreBrowserService.dpr<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})}_renderBarCursor(e,t,g,R){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillLeftLineAtCell(t,g,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()}_renderBlockCursor(e,t,g,R){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillCells(t,g,R.getWidth(),1),this._ctx.fillStyle=this._themeService.colors.cursorAccent.css,this._fillCharTrueColor(e,R,t,g),this._ctx.restore()}_renderUnderlineCursor(e,t,g,R){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillBottomLineAtCells(t,g),this._ctx.restore()}_renderBlurCursor(e,t,g,R){this._ctx.save(),this._ctx.strokeStyle=this._themeService.colors.cursor.css,this._strokeRectAtCell(t,g,R.getWidth(),1),this._ctx.restore()}}i.CursorRenderLayer=d;class v{constructor(e,t){this._renderCallback=e,this._coreBrowserService=t,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(e){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(e=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,t>0)return void this._restartInterval(t)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(t)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},e)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(e){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation(e)}}},733:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.LinkRenderLayer=void 0;const u=c(197),o=c(237),r=c(592);class d extends r.BaseRenderLayer{constructor(h,e,t,g,R,m,y){super(t,h,"link",e,!0,R,m,y),this.register(g.onShowLinkUnderline(M=>this._handleShowLinkUnderline(M))),this.register(g.onHideLinkUnderline(M=>this._handleHideLinkUnderline(M)))}resize(h,e){super.resize(h,e),this._state=void 0}reset(h){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const h=this._state.y2-this._state.y1-1;h>0&&this._clearCells(0,this._state.y1+1,this._state.cols,h),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(h){if(h.fg===o.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:h.fg!==void 0&&(0,u.is256Color)(h.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[h.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,h.y1===h.y2)this._fillBottomLineAtCells(h.x1,h.y1,h.x2-h.x1);else{this._fillBottomLineAtCells(h.x1,h.y1,h.cols-h.x1);for(let e=h.y1+1;e<h.y2;e++)this._fillBottomLineAtCells(0,e,h.cols);this._fillBottomLineAtCells(0,h.y2,h.x2)}this._state=h}_handleHideLinkUnderline(h){this._clearCurrentLink()}}i.LinkRenderLayer=d},820:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.addDisposableDomListener=void 0,i.addDisposableDomListener=function(c,u,o,r){c.addEventListener(u,o,r);let d=!1;return{dispose:()=>{d||(d=!0,c.removeEventListener(u,o,r))}}}},274:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CellColorResolver=void 0;let c,u=0,o=0,r=!1,d=!1,v=!1;i.CellColorResolver=class{constructor(h,e,t,g,R){this._terminal=h,this._selectionRenderModel=e,this._decorationService=t,this._coreBrowserService=g,this._themeService=R,this.result={fg:0,bg:0,ext:0}}resolve(h,e,t){this.result.bg=h.bg,this.result.fg=h.fg,this.result.ext=268435456&h.bg?h.extended.ext:0,o=0,u=0,d=!1,r=!1,v=!1,c=this._themeService.colors,this._decorationService.forEachDecorationAtCell(e,t,"bottom",g=>{g.backgroundColorRGB&&(o=g.backgroundColorRGB.rgba>>8&16777215,d=!0),g.foregroundColorRGB&&(u=g.foregroundColorRGB.rgba>>8&16777215,r=!0)}),v=this._selectionRenderModel.isCellSelected(this._terminal,e,t),v&&(o=(this._coreBrowserService.isFocused?c.selectionBackgroundOpaque:c.selectionInactiveBackgroundOpaque).rgba>>8&16777215,d=!0,c.selectionForeground&&(u=c.selectionForeground.rgba>>8&16777215,r=!0)),this._decorationService.forEachDecorationAtCell(e,t,"top",g=>{g.backgroundColorRGB&&(o=g.backgroundColorRGB.rgba>>8&16777215,d=!0),g.foregroundColorRGB&&(u=g.foregroundColorRGB.rgba>>8&16777215,r=!0)}),d&&(o=v?-16777216&h.bg&-134217729|o|50331648:-16777216&h.bg|o|50331648),r&&(u=-16777216&h.fg&-67108865|u|50331648),67108864&this.result.fg&&(d&&!r&&(u=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&c.background.rgba>>8|50331648,r=!0),!d&&r&&(o=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&c.foreground.rgba>>8|50331648,d=!0)),c=void 0,this.result.bg=d?o:this.result.bg,this.result.fg=r?u:this.result.fg}}},627:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.removeTerminalFromCache=i.acquireTextureAtlas=void 0;const u=c(509),o=c(197),r=[];i.acquireTextureAtlas=function(d,v,h,e,t,g,R,m){const y=(0,o.generateConfig)(e,t,g,R,v,h,m);for(let C=0;C<r.length;C++){const p=r[C],s=p.ownedBy.indexOf(d);if(s>=0){if((0,o.configEquals)(p.config,y))return p.atlas;p.ownedBy.length===1?(p.atlas.dispose(),r.splice(C,1)):p.ownedBy.splice(s,1);break}}for(let C=0;C<r.length;C++){const p=r[C];if((0,o.configEquals)(p.config,y))return p.ownedBy.push(d),p.atlas}const M=d._core,n={atlas:new u.TextureAtlas(document,y,M.unicodeService),config:y,ownedBy:[d]};return r.push(n),n.atlas},i.removeTerminalFromCache=function(d){for(let v=0;v<r.length;v++){const h=r[v].ownedBy.indexOf(d);if(h!==-1){r[v].ownedBy.length===1?(r[v].atlas.dispose(),r.splice(v,1)):r[v].ownedBy.splice(h,1);break}}}},197:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.is256Color=i.configEquals=i.generateConfig=void 0;const u=c(160);i.generateConfig=function(o,r,d,v,h,e,t){const g={foreground:e.foreground,background:e.background,cursor:u.NULL_COLOR,cursorAccent:u.NULL_COLOR,selectionForeground:u.NULL_COLOR,selectionBackgroundTransparent:u.NULL_COLOR,selectionBackgroundOpaque:u.NULL_COLOR,selectionInactiveBackgroundTransparent:u.NULL_COLOR,selectionInactiveBackgroundOpaque:u.NULL_COLOR,ansi:e.ansi.slice(),contrastCache:e.contrastCache};return{customGlyphs:h.customGlyphs,devicePixelRatio:t,letterSpacing:h.letterSpacing,lineHeight:h.lineHeight,deviceCellWidth:o,deviceCellHeight:r,deviceCharWidth:d,deviceCharHeight:v,fontFamily:h.fontFamily,fontSize:h.fontSize,fontWeight:h.fontWeight,fontWeightBold:h.fontWeightBold,allowTransparency:h.allowTransparency,drawBoldTextInBrightColors:h.drawBoldTextInBrightColors,minimumContrastRatio:h.minimumContrastRatio,colors:g}},i.configEquals=function(o,r){for(let d=0;d<o.colors.ansi.length;d++)if(o.colors.ansi[d].rgba!==r.colors.ansi[d].rgba)return!1;return o.devicePixelRatio===r.devicePixelRatio&&o.customGlyphs===r.customGlyphs&&o.lineHeight===r.lineHeight&&o.letterSpacing===r.letterSpacing&&o.fontFamily===r.fontFamily&&o.fontSize===r.fontSize&&o.fontWeight===r.fontWeight&&o.fontWeightBold===r.fontWeightBold&&o.allowTransparency===r.allowTransparency&&o.deviceCharWidth===r.deviceCharWidth&&o.deviceCharHeight===r.deviceCharHeight&&o.drawBoldTextInBrightColors===r.drawBoldTextInBrightColors&&o.minimumContrastRatio===r.minimumContrastRatio&&o.colors.foreground.rgba===r.colors.foreground.rgba&&o.colors.background.rgba===r.colors.background.rgba},i.is256Color=function(o){return(50331648&o)==16777216||(50331648&o)==33554432}},237:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TEXT_BASELINE=i.DIM_OPACITY=i.INVERTED_DEFAULT_COLOR=void 0;const u=c(399);i.INVERTED_DEFAULT_COLOR=257,i.DIM_OPACITY=.5,i.TEXT_BASELINE=u.isFirefox||u.isLegacyEdge?"bottom":"ideographic"},860:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.tryDrawCustomChar=i.powerlineDefinitions=i.boxDrawingDefinitions=i.blockElementDefinitions=void 0;const u=c(374);i.blockElementDefinitions={"‚ñÄ":[{x:0,y:0,w:8,h:4}],"‚ñÅ":[{x:0,y:7,w:8,h:1}],"‚ñÇ":[{x:0,y:6,w:8,h:2}],"‚ñÉ":[{x:0,y:5,w:8,h:3}],"‚ñÑ":[{x:0,y:4,w:8,h:4}],"‚ñÖ":[{x:0,y:3,w:8,h:5}],"‚ñÜ":[{x:0,y:2,w:8,h:6}],"‚ñá":[{x:0,y:1,w:8,h:7}],"‚ñà":[{x:0,y:0,w:8,h:8}],"‚ñâ":[{x:0,y:0,w:7,h:8}],"‚ñä":[{x:0,y:0,w:6,h:8}],"‚ñã":[{x:0,y:0,w:5,h:8}],"‚ñå":[{x:0,y:0,w:4,h:8}],"‚ñç":[{x:0,y:0,w:3,h:8}],"‚ñé":[{x:0,y:0,w:2,h:8}],"‚ñè":[{x:0,y:0,w:1,h:8}],"‚ñê":[{x:4,y:0,w:4,h:8}],"‚ñî":[{x:0,y:0,w:8,h:1}],"‚ñï":[{x:7,y:0,w:1,h:8}],"‚ññ":[{x:0,y:4,w:4,h:4}],"‚ñó":[{x:4,y:4,w:4,h:4}],"‚ñò":[{x:0,y:0,w:4,h:4}],"‚ñô":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"‚ñö":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"‚ñõ":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"‚ñú":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"‚ñù":[{x:4,y:0,w:4,h:4}],"‚ñû":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"‚ñü":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"ü≠∞":[{x:1,y:0,w:1,h:8}],"ü≠±":[{x:2,y:0,w:1,h:8}],"ü≠≤":[{x:3,y:0,w:1,h:8}],"ü≠≥":[{x:4,y:0,w:1,h:8}],"ü≠¥":[{x:5,y:0,w:1,h:8}],"ü≠µ":[{x:6,y:0,w:1,h:8}],"ü≠∂":[{x:0,y:1,w:8,h:1}],"ü≠∑":[{x:0,y:2,w:8,h:1}],"ü≠∏":[{x:0,y:3,w:8,h:1}],"ü≠π":[{x:0,y:4,w:8,h:1}],"ü≠∫":[{x:0,y:5,w:8,h:1}],"ü≠ª":[{x:0,y:6,w:8,h:1}],"ü≠º":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"ü≠Ω":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ü≠æ":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ü≠ø":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"üÆÄ":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"üÆÅ":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"üÆÇ":[{x:0,y:0,w:8,h:2}],"üÆÉ":[{x:0,y:0,w:8,h:3}],"üÆÑ":[{x:0,y:0,w:8,h:5}],"üÆÖ":[{x:0,y:0,w:8,h:6}],"üÆÜ":[{x:0,y:0,w:8,h:7}],"üÆá":[{x:6,y:0,w:2,h:8}],"üÆà":[{x:5,y:0,w:3,h:8}],"üÆâ":[{x:3,y:0,w:5,h:8}],"üÆä":[{x:2,y:0,w:6,h:8}],"üÆã":[{x:1,y:0,w:7,h:8}],"üÆï":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"üÆñ":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"üÆó":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const o={"‚ñë":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"‚ñí":[[1,0],[0,0],[0,1],[0,0]],"‚ñì":[[0,1],[1,1],[1,0],[1,1]]};i.boxDrawingDefinitions={"‚îÄ":{1:"M0,.5 L1,.5"},"‚îÅ":{3:"M0,.5 L1,.5"},"‚îÇ":{1:"M.5,0 L.5,1"},"‚îÉ":{3:"M.5,0 L.5,1"},"‚îå":{1:"M0.5,1 L.5,.5 L1,.5"},"‚îè":{3:"M0.5,1 L.5,.5 L1,.5"},"‚îê":{1:"M0,.5 L.5,.5 L.5,1"},"‚îì":{3:"M0,.5 L.5,.5 L.5,1"},"‚îî":{1:"M.5,0 L.5,.5 L1,.5"},"‚îó":{3:"M.5,0 L.5,.5 L1,.5"},"‚îò":{1:"M.5,0 L.5,.5 L0,.5"},"‚îõ":{3:"M.5,0 L.5,.5 L0,.5"},"‚îú":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"‚î£":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"‚î§":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"‚î´":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"‚î¨":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"‚î≥":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"‚î¥":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"‚îª":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"‚îº":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"‚ïã":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"‚ï¥":{1:"M.5,.5 L0,.5"},"‚ï∏":{3:"M.5,.5 L0,.5"},"‚ïµ":{1:"M.5,.5 L.5,0"},"‚ïπ":{3:"M.5,.5 L.5,0"},"‚ï∂":{1:"M.5,.5 L1,.5"},"‚ï∫":{3:"M.5,.5 L1,.5"},"‚ï∑":{1:"M.5,.5 L.5,1"},"‚ïª":{3:"M.5,.5 L.5,1"},"‚ïê":{1:(e,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"‚ïë":{1:(e,t)=>`M${.5-e},0 L${.5-e},1 M${.5+e},0 L${.5+e},1`},"‚ïí":{1:(e,t)=>`M.5,1 L.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"‚ïì":{1:(e,t)=>`M${.5-e},1 L${.5-e},.5 L1,.5 M${.5+e},.5 L${.5+e},1`},"‚ïî":{1:(e,t)=>`M1,${.5-t} L${.5-e},${.5-t} L${.5-e},1 M1,${.5+t} L${.5+e},${.5+t} L${.5+e},1`},"‚ïï":{1:(e,t)=>`M0,${.5-t} L.5,${.5-t} L.5,1 M0,${.5+t} L.5,${.5+t}`},"‚ïñ":{1:(e,t)=>`M${.5+e},1 L${.5+e},.5 L0,.5 M${.5-e},.5 L${.5-e},1`},"‚ïó":{1:(e,t)=>`M0,${.5+t} L${.5-e},${.5+t} L${.5-e},1 M0,${.5-t} L${.5+e},${.5-t} L${.5+e},1`},"‚ïò":{1:(e,t)=>`M.5,0 L.5,${.5+t} L1,${.5+t} M.5,${.5-t} L1,${.5-t}`},"‚ïô":{1:(e,t)=>`M1,.5 L${.5-e},.5 L${.5-e},0 M${.5+e},.5 L${.5+e},0`},"‚ïö":{1:(e,t)=>`M1,${.5-t} L${.5+e},${.5-t} L${.5+e},0 M1,${.5+t} L${.5-e},${.5+t} L${.5-e},0`},"‚ïõ":{1:(e,t)=>`M0,${.5+t} L.5,${.5+t} L.5,0 M0,${.5-t} L.5,${.5-t}`},"‚ïú":{1:(e,t)=>`M0,.5 L${.5+e},.5 L${.5+e},0 M${.5-e},.5 L${.5-e},0`},"‚ïù":{1:(e,t)=>`M0,${.5-t} L${.5-e},${.5-t} L${.5-e},0 M0,${.5+t} L${.5+e},${.5+t} L${.5+e},0`},"‚ïû":{1:(e,t)=>`M.5,0 L.5,1 M.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"‚ïü":{1:(e,t)=>`M${.5-e},0 L${.5-e},1 M${.5+e},0 L${.5+e},1 M${.5+e},.5 L1,.5`},"‚ï†":{1:(e,t)=>`M${.5-e},0 L${.5-e},1 M1,${.5+t} L${.5+e},${.5+t} L${.5+e},1 M1,${.5-t} L${.5+e},${.5-t} L${.5+e},0`},"‚ï°":{1:(e,t)=>`M.5,0 L.5,1 M0,${.5-t} L.5,${.5-t} M0,${.5+t} L.5,${.5+t}`},"‚ï¢":{1:(e,t)=>`M0,.5 L${.5-e},.5 M${.5-e},0 L${.5-e},1 M${.5+e},0 L${.5+e},1`},"‚ï£":{1:(e,t)=>`M${.5+e},0 L${.5+e},1 M0,${.5+t} L${.5-e},${.5+t} L${.5-e},1 M0,${.5-t} L${.5-e},${.5-t} L${.5-e},0`},"‚ï§":{1:(e,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t} M.5,${.5+t} L.5,1`},"‚ï•":{1:(e,t)=>`M0,.5 L1,.5 M${.5-e},.5 L${.5-e},1 M${.5+e},.5 L${.5+e},1`},"‚ï¶":{1:(e,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L${.5-e},${.5+t} L${.5-e},1 M1,${.5+t} L${.5+e},${.5+t} L${.5+e},1`},"‚ïß":{1:(e,t)=>`M.5,0 L.5,${.5-t} M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"‚ï®":{1:(e,t)=>`M0,.5 L1,.5 M${.5-e},.5 L${.5-e},0 M${.5+e},.5 L${.5+e},0`},"‚ï©":{1:(e,t)=>`M0,${.5+t} L1,${.5+t} M0,${.5-t} L${.5-e},${.5-t} L${.5-e},0 M1,${.5-t} L${.5+e},${.5-t} L${.5+e},0`},"‚ï™":{1:(e,t)=>`M.5,0 L.5,1 M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"‚ï´":{1:(e,t)=>`M0,.5 L1,.5 M${.5-e},0 L${.5-e},1 M${.5+e},0 L${.5+e},1`},"‚ï¨":{1:(e,t)=>`M0,${.5+t} L${.5-e},${.5+t} L${.5-e},1 M1,${.5+t} L${.5+e},${.5+t} L${.5+e},1 M0,${.5-t} L${.5-e},${.5-t} L${.5-e},0 M1,${.5-t} L${.5+e},${.5-t} L${.5+e},0`},"‚ï±":{1:"M1,0 L0,1"},"‚ï≤":{1:"M0,0 L1,1"},"‚ï≥":{1:"M1,0 L0,1 M0,0 L1,1"},"‚ïº":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"‚ïΩ":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"‚ïæ":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚ïø":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"‚îç":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"‚îé":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚îë":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"‚îí":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"‚îï":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"‚îñ":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"‚îô":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"‚îö":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"‚îù":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"‚îû":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"‚îü":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚î†":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"‚î°":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"‚î¢":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"‚î•":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"‚î¶":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"‚îß":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"‚î®":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"‚î©":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"‚î™":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"‚î≠":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚îÆ":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"‚îØ":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"‚î∞":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚î±":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"‚î≤":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"‚îµ":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚î∂":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"‚î∑":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"‚î∏":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"‚îπ":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"‚î∫":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"‚îΩ":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚îæ":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"‚îø":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"‚ïÄ":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"‚ïÅ":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚ïÇ":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"‚ïÉ":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"‚ïÑ":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"‚ïÖ":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"‚ïÜ":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"‚ïá":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"‚ïà":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"‚ïâ":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"‚ïä":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"‚ïå":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"‚ïç":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"‚îÑ":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"‚îÖ":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"‚îà":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"‚îâ":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"‚ïé":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"‚ïè":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"‚îÜ":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"‚îá":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"‚îä":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"‚îã":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"‚ï≠":{1:(e,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,1,.5`},"‚ïÆ":{1:(e,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,0,.5`},"‚ïØ":{1:(e,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,0,.5`},"‚ï∞":{1:(e,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,1,.5`}},i.powerlineDefinitions={"ÓÇ∞":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"ÓÇ±":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇ≤":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"ÓÇ≥":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇ¥":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"ÓÇµ":{d:"M0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:1,rightPadding:1},"ÓÇ∂":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"ÓÇ∑":{d:"M1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:1,leftPadding:1},"ÓÇ∏":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"ÓÇπ":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇ∫":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"ÓÇº":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"ÓÇΩ":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇæ":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},i.powerlineDefinitions["ÓÇª"]=i.powerlineDefinitions["ÓÇπ"],i.powerlineDefinitions["ÓÇø"]=i.powerlineDefinitions["ÓÇΩ"],i.tryDrawCustomChar=function(e,t,g,R,m,y,M,n){const C=i.blockElementDefinitions[t];if(C)return function(a,f,l,x,b,E){for(let L=0;L<f.length;L++){const w=f[L],T=b/8,A=E/8;a.fillRect(l+w.x*T,x+w.y*A,w.w*T,w.h*A)}}(e,C,g,R,m,y),!0;const p=o[t];if(p)return function(a,f,l,x,b,E){let L=r.get(f);L||(L=new Map,r.set(f,L));const w=a.fillStyle;if(typeof w!="string")throw new Error(`Unexpected fillStyle type "${w}"`);let T=L.get(w);if(!T){const A=f[0].length,S=f.length,P=document.createElement("canvas");P.width=A,P.height=S;const N=(0,u.throwIfFalsy)(P.getContext("2d")),O=new ImageData(A,S);let I,H,G,ie;if(w.startsWith("#"))I=parseInt(w.slice(1,3),16),H=parseInt(w.slice(3,5),16),G=parseInt(w.slice(5,7),16),ie=w.length>7&&parseInt(w.slice(7,9),16)||1;else{if(!w.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${w}" when drawing pattern glyph`);[I,H,G,ie]=w.substring(5,w.length-1).split(",").map(j=>parseFloat(j))}for(let j=0;j<S;j++)for(let K=0;K<A;K++)O.data[4*(j*A+K)]=I,O.data[4*(j*A+K)+1]=H,O.data[4*(j*A+K)+2]=G,O.data[4*(j*A+K)+3]=f[j][K]*(255*ie);N.putImageData(O,0,0),T=(0,u.throwIfFalsy)(a.createPattern(P,null)),L.set(w,T)}a.fillStyle=T,a.fillRect(l,x,b,E)}(e,p,g,R,m,y),!0;const s=i.boxDrawingDefinitions[t];if(s)return function(a,f,l,x,b,E,L){a.strokeStyle=a.fillStyle;for(const[w,T]of Object.entries(f)){let A;a.beginPath(),a.lineWidth=L*Number.parseInt(w),A=typeof T=="function"?T(.15,.15/E*b):T;for(const S of A.split(" ")){const P=S[0],N=v[P];if(!N){console.error(`Could not find drawing instructions for "${P}"`);continue}const O=S.substring(1).split(",");O[0]&&O[1]&&N(a,h(O,b,E,l,x,!0,L))}a.stroke(),a.closePath()}}(e,s,g,R,m,y,n),!0;const _=i.powerlineDefinitions[t];return!!_&&(function(a,f,l,x,b,E,L,w){var T,A;const S=new Path2D;S.rect(l,x,b,E),a.clip(S),a.beginPath();const P=L/12;a.lineWidth=w*P;for(const N of f.d.split(" ")){const O=N[0],I=v[O];if(!I){console.error(`Could not find drawing instructions for "${O}"`);continue}const H=N.substring(1).split(",");H[0]&&H[1]&&I(a,h(H,b,E,l,x,!1,w,((T=f.leftPadding)!==null&&T!==void 0?T:0)*(P/2),((A=f.rightPadding)!==null&&A!==void 0?A:0)*(P/2)))}f.type===1?(a.strokeStyle=a.fillStyle,a.stroke()):a.fill(),a.closePath()}(e,_,g,R,m,y,M,n),!0)};const r=new Map;function d(e,t,g=0){return Math.max(Math.min(e,t),g)}const v={C:(e,t)=>e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]),L:(e,t)=>e.lineTo(t[0],t[1]),M:(e,t)=>e.moveTo(t[0],t[1])};function h(e,t,g,R,m,y,M,n=0,C=0){const p=e.map(s=>parseFloat(s)||parseInt(s));if(p.length<2)throw new Error("Too few arguments for instruction");for(let s=0;s<p.length;s+=2)p[s]*=t-n*M-C*M,y&&p[s]!==0&&(p[s]=d(Math.round(p[s]+.5)-.5,t,0)),p[s]+=R+n*M;for(let s=1;s<p.length;s+=2)p[s]*=g,y&&p[s]!==0&&(p[s]=d(Math.round(p[s]+.5)-.5,g,0)),p[s]+=m;return p}},56:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.observeDevicePixelDimensions=void 0;const u=c(859);i.observeDevicePixelDimensions=function(o,r,d){let v=new r.ResizeObserver(h=>{const e=h.find(R=>R.target===o);if(!e)return;if(!("devicePixelContentBoxSize"in e))return v==null||v.disconnect(),void(v=void 0);const t=e.devicePixelContentBoxSize[0].inlineSize,g=e.devicePixelContentBoxSize[0].blockSize;t>0&&g>0&&d(t,g)});try{v.observe(o,{box:["device-pixel-content-box"]})}catch{v.disconnect(),v=void 0}return(0,u.toDisposable)(()=>v==null?void 0:v.disconnect())}},374:(B,i)=>{function c(u){return 57508<=u&&u<=57558}Object.defineProperty(i,"__esModule",{value:!0}),i.createRenderDimensions=i.excludeFromContrastRatioDemands=i.isRestrictedPowerlineGlyph=i.isPowerlineGlyph=i.throwIfFalsy=void 0,i.throwIfFalsy=function(u){if(!u)throw new Error("value must not be falsy");return u},i.isPowerlineGlyph=c,i.isRestrictedPowerlineGlyph=function(u){return 57520<=u&&u<=57527},i.excludeFromContrastRatioDemands=function(u){return c(u)||function(o){return 9472<=o&&o<=9631}(u)},i.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createSelectionRenderModel=void 0;class c{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(o,r,d,v=!1){if(this.selectionStart=r,this.selectionEnd=d,!r||!d||r[0]===d[0]&&r[1]===d[1])return void this.clear();const h=r[1]-o.buffer.active.viewportY,e=d[1]-o.buffer.active.viewportY,t=Math.max(h,0),g=Math.min(e,o.rows-1);t>=o.rows||g<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=v,this.viewportStartRow=h,this.viewportEndRow=e,this.viewportCappedStartRow=t,this.viewportCappedEndRow=g,this.startCol=r[0],this.endCol=d[0])}isCellSelected(o,r,d){return!!this.hasSelection&&(d-=o.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?r>=this.startCol&&d>=this.viewportCappedStartRow&&r<this.endCol&&d<=this.viewportCappedEndRow:r<this.startCol&&d>=this.viewportCappedStartRow&&r>=this.endCol&&d<=this.viewportCappedEndRow:d>this.viewportStartRow&&d<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&d===this.viewportStartRow&&r>=this.startCol&&r<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportEndRow&&r<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportStartRow&&r>=this.startCol)}}i.createSelectionRenderModel=function(){return new c}},509:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextureAtlas=void 0;const u=c(237),o=c(855),r=c(147),d=c(160),v=c(860),h=c(374),e=c(485),t=c(385),g=c(345),R={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let m;class y{constructor(s,_,a){this._document=s,this._config=_,this._unicodeService=a,this._didWarmUp=!1,this._cacheMap=new e.FourKeyMap,this._cacheMapCombined=new e.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new r.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new g.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new g.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=C(s,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,h.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}get pages(){return this._pages}dispose(){for(const s of this.pages)s.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const s=new t.IdleTaskQueue;for(let _=33;_<126;_++)s.enqueue(()=>{if(!this._cacheMap.get(_,o.DEFAULT_COLOR,o.DEFAULT_COLOR,o.DEFAULT_EXT)){const a=this._drawToCache(_,o.DEFAULT_COLOR,o.DEFAULT_COLOR,o.DEFAULT_EXT);this._cacheMap.set(_,o.DEFAULT_COLOR,o.DEFAULT_COLOR,o.DEFAULT_EXT,a)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const s of this._pages)s.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){y.maxAtlasPages&&this._pages.length>=Math.max(4,y.maxAtlasPages/2)&&queueMicrotask(()=>{const _=this._pages.filter(L=>2*L.canvas.width<=(y.maxTextureSize||4096)).sort((L,w)=>w.canvas.width!==L.canvas.width?w.canvas.width-L.canvas.width:w.percentageUsed-L.percentageUsed);let a=-1,f=0;for(let L=0;L<_.length;L++)if(_[L].canvas.width!==f)a=L,f=_[L].canvas.width;else if(L-a==3)break;const l=_.slice(a,a+4),x=l.map(L=>L.glyphs[0].texturePage).sort((L,w)=>L>w?1:-1),b=x[0],E=this._mergePages(l,b);E.version++,this._pages[b]=E;for(let L=x.length-1;L>=1;L--)this._deletePage(x[L]);this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(E.canvas)});const s=new M(this._document,this._textureSize);return this._pages.push(s),this._activePages.push(s),this._onAddTextureAtlasCanvas.fire(s.canvas),s}_mergePages(s,_){const a=2*s[0].canvas.width,f=new M(this._document,a,s);for(const[l,x]of s.entries()){const b=l*x.canvas.width%a,E=Math.floor(l/2)*x.canvas.height;f.ctx.drawImage(x.canvas,b,E);for(const w of x.glyphs)w.texturePage=_,w.sizeClipSpace.x=w.size.x/a,w.sizeClipSpace.y=w.size.y/a,w.texturePosition.x+=b,w.texturePosition.y+=E,w.texturePositionClipSpace.x=w.texturePosition.x/a,w.texturePositionClipSpace.y=w.texturePosition.y/a;this._onRemoveTextureAtlasCanvas.fire(x.canvas);const L=this._activePages.indexOf(x);L!==-1&&this._activePages.splice(L,1)}return f}_deletePage(s){this._pages.splice(s,1);for(let _=s;_<this._pages.length;_++){const a=this._pages[_];for(const f of a.glyphs)f.texturePage--;a.version++}}getRasterizedGlyphCombinedChar(s,_,a,f){return this._getFromCacheMap(this._cacheMapCombined,s,_,a,f)}getRasterizedGlyph(s,_,a,f){return this._getFromCacheMap(this._cacheMap,s,_,a,f)}_getFromCacheMap(s,_,a,f,l){return m=s.get(_,a,f,l),m||(m=this._drawToCache(_,a,f,l),s.set(_,a,f,l,m)),m}_getColorFromAnsiIndex(s){if(s>=this._config.colors.ansi.length)throw new Error("No color found for idx "+s);return this._config.colors.ansi[s]}_getBackgroundColor(s,_,a,f){if(this._config.allowTransparency)return d.NULL_COLOR;let l;switch(s){case 16777216:case 33554432:l=this._getColorFromAnsiIndex(_);break;case 50331648:const x=r.AttributeData.toColorRGB(_);l=d.rgba.toColor(x[0],x[1],x[2]);break;default:l=a?this._config.colors.foreground:this._config.colors.background}return f&&(l=d.color.blend(this._config.colors.background,d.color.multiplyOpacity(l,u.DIM_OPACITY))),l}_getForegroundColor(s,_,a,f,l,x,b,E,L,w){const T=this._getMinimumContrastColor(s,_,a,f,l,x,!1,L,w);if(T)return T;let A;switch(l){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&L&&x<8&&(x+=8),A=this._getColorFromAnsiIndex(x);break;case 50331648:const S=r.AttributeData.toColorRGB(x);A=d.rgba.toColor(S[0],S[1],S[2]);break;default:A=b?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(A=d.color.opaque(A)),E&&(A=d.color.multiplyOpacity(A,u.DIM_OPACITY)),A}_resolveBackgroundRgba(s,_,a){switch(s){case 16777216:case 33554432:return this._getColorFromAnsiIndex(_).rgba;case 50331648:return _<<8;default:return a?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(s,_,a,f){switch(s){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&f&&_<8&&(_+=8),this._getColorFromAnsiIndex(_).rgba;case 50331648:return _<<8;default:return a?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(s,_,a,f,l,x,b,E,L){if(this._config.minimumContrastRatio===1||L)return;const w=this._config.colors.contrastCache.getColor(s,f);if(w!==void 0)return w||void 0;const T=this._resolveBackgroundRgba(_,a,b),A=this._resolveForegroundRgba(l,x,b,E),S=d.rgba.ensureContrastRatio(T,A,this._config.minimumContrastRatio);if(!S)return void this._config.colors.contrastCache.setColor(s,f,null);const P=d.rgba.toColor(S>>24&255,S>>16&255,S>>8&255);return this._config.colors.contrastCache.setColor(s,f,P),P}_drawToCache(s,_,a,f){const l=typeof s=="number"?String.fromCharCode(s):s,x=this._config.deviceCellWidth*Math.max(l.length,2)+4;this._tmpCanvas.width<x&&(this._tmpCanvas.width=x);const b=this._config.deviceCellHeight+8;if(this._tmpCanvas.height<b&&(this._tmpCanvas.height=b),this._tmpCtx.save(),this._workAttributeData.fg=a,this._workAttributeData.bg=_,this._workAttributeData.extended.ext=f,this._workAttributeData.isInvisible())return R;const E=!!this._workAttributeData.isBold(),L=!!this._workAttributeData.isInverse(),w=!!this._workAttributeData.isDim(),T=!!this._workAttributeData.isItalic(),A=!!this._workAttributeData.isUnderline(),S=!!this._workAttributeData.isStrikethrough();let P=this._workAttributeData.getFgColor(),N=this._workAttributeData.getFgColorMode(),O=this._workAttributeData.getBgColor(),I=this._workAttributeData.getBgColorMode();if(L){const D=P;P=O,O=D;const k=N;N=I,I=k}const H=this._getBackgroundColor(I,O,L,w);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=H.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const G=E?this._config.fontWeightBold:this._config.fontWeight,ie=T?"italic":"";this._tmpCtx.font=`${ie} ${G} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=u.TEXT_BASELINE;const j=l.length===1&&(0,h.isPowerlineGlyph)(l.charCodeAt(0)),K=l.length===1&&(0,h.isRestrictedPowerlineGlyph)(l.charCodeAt(0)),ne=this._getForegroundColor(_,I,O,a,N,P,L,w,E,(0,h.excludeFromContrastRatioDemands)(l.charCodeAt(0)));this._tmpCtx.fillStyle=ne.css;const W=K?0:4;let ae=!1;this._config.customGlyphs!==!1&&(ae=(0,v.tryDrawCustomChar)(this._tmpCtx,l,W,W,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let ue,se=!j;if(ue=typeof s=="number"?this._unicodeService.wcwidth(s):this._unicodeService.getStringCellWidth(s),A){this._tmpCtx.save();const D=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),k=D%2==1?.5:0;if(this._tmpCtx.lineWidth=D,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())se=!1,this._tmpCtx.strokeStyle=`rgb(${r.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{se=!1;let V=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&V<8&&(V+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(V).css}this._tmpCtx.beginPath();const Y=W,q=Math.ceil(W+this._config.deviceCharHeight)-k,re=W+this._config.deviceCharHeight+D-k,oe=Math.ceil(W+this._config.deviceCharHeight+2*D)-k;for(let V=0;V<ue;V++){this._tmpCtx.save();const z=Y+V*this._config.deviceCellWidth,Q=Y+(V+1)*this._config.deviceCellWidth,ge=z+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(z,q),this._tmpCtx.lineTo(Q,q),this._tmpCtx.moveTo(z,oe),this._tmpCtx.lineTo(Q,oe);break;case 3:const le=D<=1?oe:Math.ceil(W+this._config.deviceCharHeight-D/2)-k,ce=D<=1?q:Math.ceil(W+this._config.deviceCharHeight+D/2)-k,fe=new Path2D;fe.rect(z,q,this._config.deviceCellWidth,oe-q),this._tmpCtx.clip(fe),this._tmpCtx.moveTo(z-this._config.deviceCellWidth/2,re),this._tmpCtx.bezierCurveTo(z-this._config.deviceCellWidth/2,ce,z,ce,z,re),this._tmpCtx.bezierCurveTo(z,le,ge,le,ge,re),this._tmpCtx.bezierCurveTo(ge,ce,Q,ce,Q,re),this._tmpCtx.bezierCurveTo(Q,le,Q+this._config.deviceCellWidth/2,le,Q+this._config.deviceCellWidth/2,re);break;case 4:this._tmpCtx.setLineDash([2*this._config.devicePixelRatio,this._config.devicePixelRatio]),this._tmpCtx.moveTo(z,q),this._tmpCtx.lineTo(Q,q);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(z,q),this._tmpCtx.lineTo(Q,q);break;default:this._tmpCtx.moveTo(z,q),this._tmpCtx.lineTo(Q,q)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!ae&&this._config.fontSize>=12&&!this._config.allowTransparency&&l!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const V=this._tmpCtx.measureText(l);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in V&&V.actualBoundingBoxDescent>0){this._tmpCtx.save();const z=new Path2D;z.rect(Y,q-Math.ceil(D/2),this._config.deviceCellWidth,oe-q+Math.ceil(D/2)),this._tmpCtx.clip(z),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=H.css,this._tmpCtx.strokeText(l,W,W+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(ae||this._tmpCtx.fillText(l,W,W+this._config.deviceCharHeight),l==="_"&&!this._config.allowTransparency){let D=n(this._tmpCtx.getImageData(W,W,this._config.deviceCellWidth,this._config.deviceCellHeight),H,ne,se);if(D)for(let k=1;k<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=H.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(l,W,W+this._config.deviceCharHeight-k),D=n(this._tmpCtx.getImageData(W,W,this._config.deviceCellWidth,this._config.deviceCellHeight),H,ne,se),D);k++);}if(S){const D=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),k=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=D,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(W,W+Math.floor(this._config.deviceCharHeight/2)-k),this._tmpCtx.lineTo(W+this._config.deviceCharWidth*ue,W+Math.floor(this._config.deviceCharHeight/2)-k),this._tmpCtx.stroke()}this._tmpCtx.restore();const he=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let ve;if(ve=this._config.allowTransparency?function(D){for(let k=0;k<D.data.length;k+=4)if(D.data[k+3]>0)return!1;return!0}(he):n(he,H,ne,se),ve)return R;const U=this._findGlyphBoundingBox(he,this._workBoundingBox,x,K,ae,W);let F,$;for(;;){if(this._activePages.length===0){const D=this._createNewPage();F=D,$=D.currentRow,$.height=U.size.y;break}F=this._activePages[this._activePages.length-1],$=F.currentRow;for(const D of this._activePages)U.size.y<=D.currentRow.height&&(F=D,$=D.currentRow);for(let D=this._activePages.length-1;D>=0;D--)for(const k of this._activePages[D].fixedRows)k.height<=$.height&&U.size.y<=k.height&&(F=this._activePages[D],$=k);if($.y+U.size.y>=F.canvas.height||$.height>U.size.y+2){let D=!1;if(F.currentRow.y+F.currentRow.height+U.size.y>=F.canvas.height){let k;for(const Y of this._activePages)if(Y.currentRow.y+Y.currentRow.height+U.size.y<Y.canvas.height){k=Y;break}if(k)F=k;else{const Y=this._createNewPage();F=Y,$=Y.currentRow,$.height=U.size.y,D=!0}}D||(F.currentRow.height>0&&F.fixedRows.push(F.currentRow),$={x:0,y:F.currentRow.y+F.currentRow.height,height:U.size.y},F.fixedRows.push($),F.currentRow={x:0,y:$.y+$.height,height:0})}if($.x+U.size.x<=F.canvas.width)break;$===F.currentRow?($.x=0,$.y+=$.height,$.height=0):F.fixedRows.splice(F.fixedRows.indexOf($),1)}return U.texturePage=this._pages.indexOf(F),U.texturePosition.x=$.x,U.texturePosition.y=$.y,U.texturePositionClipSpace.x=$.x/F.canvas.width,U.texturePositionClipSpace.y=$.y/F.canvas.height,U.sizeClipSpace.x/=F.canvas.width,U.sizeClipSpace.y/=F.canvas.height,$.height=Math.max($.height,U.size.y),$.x+=U.size.x,F.ctx.putImageData(he,U.texturePosition.x-this._workBoundingBox.left,U.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,U.size.x,U.size.y),F.addGlyph(U),F.version++,U}_findGlyphBoundingBox(s,_,a,f,l,x){_.top=0;const b=f?this._config.deviceCellHeight:this._tmpCanvas.height,E=f?this._config.deviceCellWidth:a;let L=!1;for(let w=0;w<b;w++){for(let T=0;T<E;T++){const A=w*this._tmpCanvas.width*4+4*T+3;if(s.data[A]!==0){_.top=w,L=!0;break}}if(L)break}_.left=0,L=!1;for(let w=0;w<x+E;w++){for(let T=0;T<b;T++){const A=T*this._tmpCanvas.width*4+4*w+3;if(s.data[A]!==0){_.left=w,L=!0;break}}if(L)break}_.right=E,L=!1;for(let w=x+E-1;w>=x;w--){for(let T=0;T<b;T++){const A=T*this._tmpCanvas.width*4+4*w+3;if(s.data[A]!==0){_.right=w,L=!0;break}}if(L)break}_.bottom=b,L=!1;for(let w=b-1;w>=0;w--){for(let T=0;T<E;T++){const A=w*this._tmpCanvas.width*4+4*T+3;if(s.data[A]!==0){_.bottom=w,L=!0;break}}if(L)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:_.right-_.left+1,y:_.bottom-_.top+1},sizeClipSpace:{x:_.right-_.left+1,y:_.bottom-_.top+1},offset:{x:-_.left+x+(f||l?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-_.top+x+(f||l?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}i.TextureAtlas=y;class M{constructor(s,_,a){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],a)for(const f of a)this._glyphs.push(...f.glyphs),this._usedPixels+=f._usedPixels;this.canvas=C(s,_,_),this.ctx=(0,h.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(s){this._glyphs.push(s),this._usedPixels+=s.size.x*s.size.y}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function n(p,s,_,a){const f=s.rgba>>>24,l=s.rgba>>>16&255,x=s.rgba>>>8&255,b=_.rgba>>>24,E=_.rgba>>>16&255,L=_.rgba>>>8&255,w=Math.floor((Math.abs(f-b)+Math.abs(l-E)+Math.abs(x-L))/12);let T=!0;for(let A=0;A<p.data.length;A+=4)p.data[A]===f&&p.data[A+1]===l&&p.data[A+2]===x||a&&Math.abs(p.data[A]-f)+Math.abs(p.data[A+1]-l)+Math.abs(p.data[A+2]-x)<w?p.data[A+3]=0:T=!1;return T}function C(p,s,_){const a=p.createElement("canvas");return a.width=s,a.height=_,a}},160:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.contrastRatio=i.toPaddedHex=i.rgba=i.rgb=i.css=i.color=i.channels=i.NULL_COLOR=void 0;const u=c(399);let o=0,r=0,d=0,v=0;var h,e,t;function g(m){const y=m.toString(16);return y.length<2?"0"+y:y}function R(m,y){return m<y?(y+.05)/(m+.05):(m+.05)/(y+.05)}i.NULL_COLOR={css:"#00000000",rgba:0},function(m){m.toCss=function(y,M,n,C){return C!==void 0?`#${g(y)}${g(M)}${g(n)}${g(C)}`:`#${g(y)}${g(M)}${g(n)}`},m.toRgba=function(y,M,n,C=255){return(y<<24|M<<16|n<<8|C)>>>0}}(h=i.channels||(i.channels={})),function(m){function y(M,n){return v=Math.round(255*n),[o,r,d]=t.toChannels(M.rgba),{css:h.toCss(o,r,d,v),rgba:h.toRgba(o,r,d,v)}}m.blend=function(M,n){if(v=(255&n.rgba)/255,v===1)return{css:n.css,rgba:n.rgba};const C=n.rgba>>24&255,p=n.rgba>>16&255,s=n.rgba>>8&255,_=M.rgba>>24&255,a=M.rgba>>16&255,f=M.rgba>>8&255;return o=_+Math.round((C-_)*v),r=a+Math.round((p-a)*v),d=f+Math.round((s-f)*v),{css:h.toCss(o,r,d),rgba:h.toRgba(o,r,d)}},m.isOpaque=function(M){return(255&M.rgba)==255},m.ensureContrastRatio=function(M,n,C){const p=t.ensureContrastRatio(M.rgba,n.rgba,C);if(p)return t.toColor(p>>24&255,p>>16&255,p>>8&255)},m.opaque=function(M){const n=(255|M.rgba)>>>0;return[o,r,d]=t.toChannels(n),{css:h.toCss(o,r,d),rgba:n}},m.opacity=y,m.multiplyOpacity=function(M,n){return v=255&M.rgba,y(M,v*n/255)},m.toColorRGB=function(M){return[M.rgba>>24&255,M.rgba>>16&255,M.rgba>>8&255]}}(i.color||(i.color={})),function(m){let y,M;if(!u.isNode){const n=document.createElement("canvas");n.width=1,n.height=1;const C=n.getContext("2d",{willReadFrequently:!0});C&&(y=C,y.globalCompositeOperation="copy",M=y.createLinearGradient(0,0,1,1))}m.toColor=function(n){if(n.match(/#[\da-f]{3,8}/i))switch(n.length){case 4:return o=parseInt(n.slice(1,2).repeat(2),16),r=parseInt(n.slice(2,3).repeat(2),16),d=parseInt(n.slice(3,4).repeat(2),16),t.toColor(o,r,d);case 5:return o=parseInt(n.slice(1,2).repeat(2),16),r=parseInt(n.slice(2,3).repeat(2),16),d=parseInt(n.slice(3,4).repeat(2),16),v=parseInt(n.slice(4,5).repeat(2),16),t.toColor(o,r,d,v);case 7:return{css:n,rgba:(parseInt(n.slice(1),16)<<8|255)>>>0};case 9:return{css:n,rgba:parseInt(n.slice(1),16)>>>0}}const C=n.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return o=parseInt(C[1]),r=parseInt(C[2]),d=parseInt(C[3]),v=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),t.toColor(o,r,d,v);if(!y||!M)throw new Error("css.toColor: Unsupported css format");if(y.fillStyle=M,y.fillStyle=n,typeof y.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(y.fillRect(0,0,1,1),[o,r,d,v]=y.getImageData(0,0,1,1).data,v!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:h.toRgba(o,r,d,v),css:n}}}(i.css||(i.css={})),function(m){function y(M,n,C){const p=M/255,s=n/255,_=C/255;return .2126*(p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4))+.7152*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.0722*(_<=.03928?_/12.92:Math.pow((_+.055)/1.055,2.4))}m.relativeLuminance=function(M){return y(M>>16&255,M>>8&255,255&M)},m.relativeLuminance2=y}(e=i.rgb||(i.rgb={})),function(m){function y(n,C,p){const s=n>>24&255,_=n>>16&255,a=n>>8&255;let f=C>>24&255,l=C>>16&255,x=C>>8&255,b=R(e.relativeLuminance2(f,l,x),e.relativeLuminance2(s,_,a));for(;b<p&&(f>0||l>0||x>0);)f-=Math.max(0,Math.ceil(.1*f)),l-=Math.max(0,Math.ceil(.1*l)),x-=Math.max(0,Math.ceil(.1*x)),b=R(e.relativeLuminance2(f,l,x),e.relativeLuminance2(s,_,a));return(f<<24|l<<16|x<<8|255)>>>0}function M(n,C,p){const s=n>>24&255,_=n>>16&255,a=n>>8&255;let f=C>>24&255,l=C>>16&255,x=C>>8&255,b=R(e.relativeLuminance2(f,l,x),e.relativeLuminance2(s,_,a));for(;b<p&&(f<255||l<255||x<255);)f=Math.min(255,f+Math.ceil(.1*(255-f))),l=Math.min(255,l+Math.ceil(.1*(255-l))),x=Math.min(255,x+Math.ceil(.1*(255-x))),b=R(e.relativeLuminance2(f,l,x),e.relativeLuminance2(s,_,a));return(f<<24|l<<16|x<<8|255)>>>0}m.ensureContrastRatio=function(n,C,p){const s=e.relativeLuminance(n>>8),_=e.relativeLuminance(C>>8);if(R(s,_)<p){if(_<s){const l=y(n,C,p),x=R(s,e.relativeLuminance(l>>8));if(x<p){const b=M(n,C,p);return x>R(s,e.relativeLuminance(b>>8))?l:b}return l}const a=M(n,C,p),f=R(s,e.relativeLuminance(a>>8));if(f<p){const l=y(n,C,p);return f>R(s,e.relativeLuminance(l>>8))?a:l}return a}},m.reduceLuminance=y,m.increaseLuminance=M,m.toChannels=function(n){return[n>>24&255,n>>16&255,n>>8&255,255&n]},m.toColor=function(n,C,p,s){return{css:h.toCss(n,C,p,s),rgba:h.toRgba(n,C,p,s)}}}(t=i.rgba||(i.rgba={})),i.toPaddedHex=g,i.contrastRatio=R},345:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.forwardEvent=i.EventEmitter=void 0,i.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=c=>(this._listeners.push(c),{dispose:()=>{if(!this._disposed){for(let u=0;u<this._listeners.length;u++)if(this._listeners[u]===c)return void this._listeners.splice(u,1)}}})),this._event}fire(c,u){const o=[];for(let r=0;r<this._listeners.length;r++)o.push(this._listeners[r]);for(let r=0;r<o.length;r++)o[r].call(void 0,c,u)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},i.forwardEvent=function(c,u){return c(o=>u.fire(o))}},859:(B,i)=>{function c(u){for(const o of u)o.dispose();u.length=0}Object.defineProperty(i,"__esModule",{value:!0}),i.getDisposeArrayDisposable=i.disposeArray=i.toDisposable=i.Disposable=void 0,i.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const u of this._disposables)u.dispose();this._disposables.length=0}register(u){return this._disposables.push(u),u}unregister(u){const o=this._disposables.indexOf(u);o!==-1&&this._disposables.splice(o,1)}},i.toDisposable=function(u){return{dispose:u}},i.disposeArray=c,i.getDisposeArrayDisposable=function(u){return{dispose:()=>c(u)}}},485:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FourKeyMap=i.TwoKeyMap=void 0;class c{constructor(){this._data={}}set(o,r,d){this._data[o]||(this._data[o]={}),this._data[o][r]=d}get(o,r){return this._data[o]?this._data[o][r]:void 0}clear(){this._data={}}}i.TwoKeyMap=c,i.FourKeyMap=class{constructor(){this._data=new c}set(u,o,r,d,v){this._data.get(u,o)||this._data.set(u,o,new c),this._data.get(u,o).set(r,d,v)}get(u,o,r,d){var v;return(v=this._data.get(u,o))===null||v===void 0?void 0:v.get(r,d)}clear(){this._data.clear()}}},399:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isChromeOS=i.isLinux=i.isWindows=i.isIphone=i.isIpad=i.isMac=i.getSafariVersion=i.isSafari=i.isLegacyEdge=i.isFirefox=i.isNode=void 0,i.isNode=typeof navigator>"u";const c=i.isNode?"node":navigator.userAgent,u=i.isNode?"node":navigator.platform;i.isFirefox=c.includes("Firefox"),i.isLegacyEdge=c.includes("Edge"),i.isSafari=/^((?!chrome|android).)*safari/i.test(c),i.getSafariVersion=function(){if(!i.isSafari)return 0;const o=c.match(/Version\/(\d+)/);return o===null||o.length<2?0:parseInt(o[1])},i.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(u),i.isIpad=u==="iPad",i.isIphone=u==="iPhone",i.isWindows=["Windows","Win16","Win32","WinCE"].includes(u),i.isLinux=u.indexOf("Linux")>=0,i.isChromeOS=/\bCrOS\b/.test(c)},385:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DebouncedIdleTask=i.IdleTaskQueue=i.PriorityTaskQueue=void 0;const u=c(399);class o{constructor(){this._tasks=[],this._i=0}enqueue(v){this._tasks.push(v),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(v){this._idleCallback=void 0;let h=0,e=0,t=v.timeRemaining(),g=0;for(;this._i<this._tasks.length;){if(h=Date.now(),this._tasks[this._i]()||this._i++,h=Math.max(1,Date.now()-h),e=Math.max(h,e),g=v.timeRemaining(),1.5*e>g)return t-h<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-h))}ms`),void this._start();t=g}this.clear()}}class r extends o{_requestCallback(v){return setTimeout(()=>v(this._createDeadline(16)))}_cancelCallback(v){clearTimeout(v)}_createDeadline(v){const h=Date.now()+v;return{timeRemaining:()=>Math.max(0,h-Date.now())}}}i.PriorityTaskQueue=r,i.IdleTaskQueue=!u.isNode&&"requestIdleCallback"in window?class extends o{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:r,i.DebouncedIdleTask=class{constructor(){this._queue=new i.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},147:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ExtendedAttrs=i.AttributeData=void 0;class c{constructor(){this.fg=0,this.bg=0,this.extended=new u}static toColorRGB(r){return[r>>>16&255,r>>>8&255,255&r]}static fromColorRGB(r){return(255&r[0])<<16|(255&r[1])<<8|255&r[2]}clone(){const r=new c;return r.fg=this.fg,r.bg=this.bg,r.extended=this.extended.clone(),r}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}i.AttributeData=c;class u{constructor(r=0,d=0){this._ext=0,this._urlId=0,this._ext=r,this._urlId=d}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(r){this._ext=r}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(r){this._ext&=-469762049,this._ext|=r<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(r){this._ext&=-67108864,this._ext|=67108863&r}get urlId(){return this._urlId}set urlId(r){this._urlId=r}clone(){return new u(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}i.ExtendedAttrs=u},782:(B,i,c)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CellData=void 0;const u=c(133),o=c(855),r=c(147);class d extends r.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new r.ExtendedAttrs,this.combinedData=""}static fromCharData(h){const e=new d;return e.setFromCharData(h),e}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,u.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(h){this.fg=h[o.CHAR_DATA_ATTR_INDEX],this.bg=0;let e=!1;if(h[o.CHAR_DATA_CHAR_INDEX].length>2)e=!0;else if(h[o.CHAR_DATA_CHAR_INDEX].length===2){const t=h[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const g=h[o.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=g&&g<=57343?this.content=1024*(t-55296)+g-56320+65536|h[o.CHAR_DATA_WIDTH_INDEX]<<22:e=!0}else e=!0}else this.content=h[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|h[o.CHAR_DATA_WIDTH_INDEX]<<22;e&&(this.combinedData=h[o.CHAR_DATA_CHAR_INDEX],this.content=2097152|h[o.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.CellData=d},855:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WHITESPACE_CELL_CODE=i.WHITESPACE_CELL_WIDTH=i.WHITESPACE_CELL_CHAR=i.NULL_CELL_CODE=i.NULL_CELL_WIDTH=i.NULL_CELL_CHAR=i.CHAR_DATA_CODE_INDEX=i.CHAR_DATA_WIDTH_INDEX=i.CHAR_DATA_CHAR_INDEX=i.CHAR_DATA_ATTR_INDEX=i.DEFAULT_EXT=i.DEFAULT_ATTR=i.DEFAULT_COLOR=void 0,i.DEFAULT_COLOR=0,i.DEFAULT_ATTR=256|i.DEFAULT_COLOR<<9,i.DEFAULT_EXT=0,i.CHAR_DATA_ATTR_INDEX=0,i.CHAR_DATA_CHAR_INDEX=1,i.CHAR_DATA_WIDTH_INDEX=2,i.CHAR_DATA_CODE_INDEX=3,i.NULL_CELL_CHAR="",i.NULL_CELL_WIDTH=1,i.NULL_CELL_CODE=0,i.WHITESPACE_CELL_CHAR=" ",i.WHITESPACE_CELL_WIDTH=1,i.WHITESPACE_CELL_CODE=32},133:(B,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Utf8ToUtf32=i.StringToUtf32=i.utf32ToString=i.stringFromCodePoint=void 0,i.stringFromCodePoint=function(c){return c>65535?(c-=65536,String.fromCharCode(55296+(c>>10))+String.fromCharCode(c%1024+56320)):String.fromCharCode(c)},i.utf32ToString=function(c,u=0,o=c.length){let r="";for(let d=u;d<o;++d){let v=c[d];v>65535?(v-=65536,r+=String.fromCharCode(55296+(v>>10))+String.fromCharCode(v%1024+56320)):r+=String.fromCharCode(v)}return r},i.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(c,u){const o=c.length;if(!o)return 0;let r=0,d=0;if(this._interim){const v=c.charCodeAt(d++);56320<=v&&v<=57343?u[r++]=1024*(this._interim-55296)+v-56320+65536:(u[r++]=this._interim,u[r++]=v),this._interim=0}for(let v=d;v<o;++v){const h=c.charCodeAt(v);if(55296<=h&&h<=56319){if(++v>=o)return this._interim=h,r;const e=c.charCodeAt(v);56320<=e&&e<=57343?u[r++]=1024*(h-55296)+e-56320+65536:(u[r++]=h,u[r++]=e)}else h!==65279&&(u[r++]=h)}return r}},i.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(c,u){const o=c.length;if(!o)return 0;let r,d,v,h,e=0,t=0,g=0;if(this.interim[0]){let y=!1,M=this.interim[0];M&=(224&M)==192?31:(240&M)==224?15:7;let n,C=0;for(;(n=63&this.interim[++C])&&C<4;)M<<=6,M|=n;const p=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,s=p-C;for(;g<s;){if(g>=o)return 0;if(n=c[g++],(192&n)!=128){g--,y=!0;break}this.interim[C++]=n,M<<=6,M|=63&n}y||(p===2?M<128?g--:u[e++]=M:p===3?M<2048||M>=55296&&M<=57343||M===65279||(u[e++]=M):M<65536||M>1114111||(u[e++]=M)),this.interim.fill(0)}const R=o-4;let m=g;for(;m<o;){for(;!(!(m<R)||128&(r=c[m])||128&(d=c[m+1])||128&(v=c[m+2])||128&(h=c[m+3]));)u[e++]=r,u[e++]=d,u[e++]=v,u[e++]=h,m+=4;if(r=c[m++],r<128)u[e++]=r;else if((224&r)==192){if(m>=o)return this.interim[0]=r,e;if(d=c[m++],(192&d)!=128){m--;continue}if(t=(31&r)<<6|63&d,t<128){m--;continue}u[e++]=t}else if((240&r)==224){if(m>=o)return this.interim[0]=r,e;if(d=c[m++],(192&d)!=128){m--;continue}if(m>=o)return this.interim[0]=r,this.interim[1]=d,e;if(v=c[m++],(192&v)!=128){m--;continue}if(t=(15&r)<<12|(63&d)<<6|63&v,t<2048||t>=55296&&t<=57343||t===65279)continue;u[e++]=t}else if((248&r)==240){if(m>=o)return this.interim[0]=r,e;if(d=c[m++],(192&d)!=128){m--;continue}if(m>=o)return this.interim[0]=r,this.interim[1]=d,e;if(v=c[m++],(192&v)!=128){m--;continue}if(m>=o)return this.interim[0]=r,this.interim[1]=d,this.interim[2]=v,e;if(h=c[m++],(192&h)!=128){m--;continue}if(t=(7&r)<<18|(63&d)<<12|(63&v)<<6|63&h,t<65536||t>1114111)continue;u[e++]=t}}return e}}}},J={};function X(B){var i=J[B];if(i!==void 0)return i.exports;var c=J[B]={exports:{}};return ee[B](c,c.exports,X),c.exports}var te={};return(()=>{var B=te;Object.defineProperty(B,"__esModule",{value:!0}),B.WebglAddon=void 0;const i=X(345),c=X(859),u=X(399),o=X(666);class r extends c.Disposable{constructor(v){if(u.isSafari&&(0,u.getSafariVersion)()<16)throw new Error("Webgl2 is only supported on Safari 16 and above");super(),this._preserveDrawingBuffer=v,this._onChangeTextureAtlas=this.register(new i.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new i.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new i.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new i.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(v){const h=v._core;if(!v.element)return void this.register(h.onWillOpen(()=>this.activate(v)));this._terminal=v;const e=h.coreService,t=h.optionsService,g=h,R=g._renderService,m=g._characterJoinerService,y=g._charSizeService,M=g._coreBrowserService,n=g._decorationService,C=g._themeService;this._renderer=this.register(new o.WebglRenderer(v,m,y,M,e,n,t,C,this._preserveDrawingBuffer)),this.register((0,i.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,i.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,i.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,i.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),R.setRenderer(this._renderer),this.register((0,c.toDisposable)(()=>{const p=this._terminal._core._renderService;p.setRenderer(this._terminal._core._createRenderer()),p.handleResize(v.cols,v.rows)}))}get textureAtlas(){var v;return(v=this._renderer)===null||v===void 0?void 0:v.textureAtlas}clearTextureAtlas(){var v;(v=this._renderer)===null||v===void 0||v.clearTextureAtlas()}}B.WebglAddon=r})(),te})()})})(me);const xe=Ce(de),we=pe({__proto__:null,default:xe},[de]);export{we as x};
